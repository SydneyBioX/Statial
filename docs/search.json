[{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Statial","text":"","code":"# Install the package from Bioconductor if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {   install.packages(\"BiocManager\") } BiocManager::install(\"Statial\")"},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Statial","text":"37 trillion cells human body, taking different forms functions. behaviour cells can described canonical characteristics, functions can also dynamically change based environmental context, leading cells diverse states. Understanding changes cell state interplay cells key understanding mechanisms action contribute human disease. Statial suite functions identifying changes cell state. guide provide step--step overview key functions within Statial.","code":""},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"loading-example-data","dir":"Articles","previous_headings":"","what":"Loading example data","title":"Statial","text":"following analyse breast cancer data Keren et al. 2018. images stored SingleCellExperiment object. object contains 57811 cells across 10 images includes information cell type patient survival. Note: original dataset reduced 41 images 10 images purposes vignette, due size restrictions.","code":"# Load head and neck data data(\"kerenSCE\")  kerenSCE #> class: SingleCellExperiment  #> dim: 48 57811  #> metadata(0): #> assays(1): intensities #> rownames(48): Na Si ... Ta Au #> rowData names(0): #> colnames(57811): 1 2 ... 171281 171282 #> colData names(8): x y ... Survival_days_capped Censored #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"evaluating-cell-localisation","dir":"Articles","previous_headings":"","what":"Evaluating cell localisation","title":"Statial","text":"Kontextual method evaluate localisation relationship two cell types image. Kontextual builds L-function contextualising relationship two cell types reference typical spatial behaviour \\(3^{rd}\\) cell type/population. taking approach, Kontextual invariant changes window image well tissue structures may present. definitions cell types cell states somewhat ambiguous, cell types imply well defined groups cells serve different roles one another, hand cell states imply cells dynamic entity discretised, thus exist continuum. purposes using Kontextual treat cell states identified clusters cells, larger clusters represent “parent” cell population, finer sub-clusters representing “child” cell population. example CD4 T cell may considered child larger parent population Immune cells. Kontextual thus aims see child population cells deviate spatial behaviour parent population, influences localisation child cell state another cell state.","code":""},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"kontextual","dir":"Articles","previous_headings":"","what":"Kontextual","title":"Statial","text":"first step analysing images organise cells present cell state populations clusters, e.g. different B cell types put vector called bcells. Kontextual accepts SingleCellExperiment object, single image, list images SingleCellExperiment object, gets passed cells argument. two cell types evaluated specified arguments. parent population must also specified parent argument, note parent cell population must include cell type. argument r specify radius cell relationship evaluated . Kontextual supports parallel processing, number cores can specified using cores argument. Kontextual can take single value multiple values argument test combinations arguments specified.","code":"# Examine all cell types in image unique(kerenSCE$cellType) #>  [1] \"Keratin_Tumour\" \"CD3_Cell\"       \"B\"              \"CD4_Cell\"       #>  [5] \"Dc/Mono\"        \"Unidentified\"   \"Macrophages\"    \"CD8_Cell\"       #>  [9] \"other immune\"   \"Endothelial\"    \"Mono/Neu\"       \"Mesenchymal\"    #> [13] \"Neutrophils\"    \"NK\"             \"Tumour\"         \"DC\"             #> [17] \"Tregs\"  # Set up cell populations tumour <- c(\"Keratin_Tumour\", \"Tumour\")  bcells <- c(\"B\") tcells <- c(\"CD3_Cell\", \"CD4_Cell\", \"CD8_Cell\", \"Tregs\") myeloid <- c(\"Dc/Mono\", \"DC\", \"Mono/Neu\", \"Macrophages\", \"Neutrophils\")  endothelial <- c(\"Endothelial\") mesenchymal <- c(\"Mesenchymal\")  tissue <- c(endothelial, mesenchymal) immune <- c(bcells, tcells, myeloid, \"NK\", \"other immune\") # NK = Natural Killer cells  all <- c(tumour, tissue, immune, \"Unidentified\")"},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"kontextual-curve","dir":"Articles","previous_headings":"","what":"Kontextual Curve","title":"Statial","text":"examine image 6 Keren et al. dataset relationship 2 cell types depends parent cell population. image can see p53 Immune dispersed. However behaviour p53 placed context spatial behaviour parent population Keratin+Tumour, p53 Immune now appear localised.  kontextCurve function plots L-function value Kontextual values range radii. points lie red line (expected pattern) localisation indicated radius, points lie red line dispersion indicated. seen following plot Kontextual able correctly identify localisation p53 Immune example image certain range radii. radius gets large overall relationship p53 Immune looks dispersed. original L-function able identify localisation value radii.  can calculate relationships across images single radius. Alternatively pairwise cell relationships corresponding parent dataset can tested. data frame pairwise combinations can creating using parentCombinations function. function takes vector cells, well parent vectors set earlier. shown output data frame specifying , , parent arguments Kontextual. Rather specifying , , parent Kontextual, output parentCombinations can inputed Kontextual using parentDf argument, examine pairwise relationships dataset. chunk take signficant amount time run, demonstration results saved loaded .","code":"#Select image 6 from the kerenSCE dataset kerenImage6 = kerenSCE[, kerenSCE$imageID ==\"6\"]  #Select for all cells that express higher than baseline level of p53 p53Pos = assay(kerenImage6)[\"p53\",]  |>    as.numeric() > -0.300460 kerenImage6$cellType[p53Pos & kerenImage6$cellType %in% c(\"Keratin_Tumour\")] <- \"p53+Tumour\"  #Group all immune cells under the name \"Immune\" kerenImage6$cellType[kerenImage6$cellType %in% immune] <- \"Immune\"  kerenImage6 |>   colData() %>%   as.data.frame() %>%   filter(cellType %in% c(\"Keratin_Tumour\", \"Immune\", \"p53+Tumour\")) %>%   arrange(cellType) %>%   ggplot(aes(x = x, y = y, color = cellType)) +   geom_point(size = 1) +   scale_colour_manual(values = c(\"#505050\", \"#D6D6D6\", \"#64BC46\")) #Select for all cells that express higher than baseline level of p53 kerenSCE$cellTypeNew <- kerenSCE$cellType p53Pos = assay(kerenSCE)[\"p53\",]  |>    as.numeric() > -0.300460 kerenSCE$cellTypeNew[p53Pos & kerenSCE$cellType %in% c(\"Keratin_Tumour\")] <- \"p53+Tumour\"  #Group all immune cells under the name \"Immune\" kerenSCE$cellTypeNew[kerenSCE$cellType %in% immune] <- \"Immune\"   curves <- kontextCurve(   cells = kerenSCE,   from = \"p53+Tumour\",   to = \"Immune\",   parent = c(\"p53+Tumour\", \"Keratin_Tumour\"),   rs = seq(10, 510, 100),   image = \"6\",   cellType = \"cellTypeNew\",   cores = nCores )  kontextPlot(curves) p53_Kontextual <- Kontextual(   cells = kerenSCE,   r = 50,   from = \"p53+Tumour\",   to = \"Immune\",   parent = c(\"p53\", \"Keratin_Tumour\"),   cellType = \"cellTypeNew\" )  p53_Kontextual #>    imageID               test  original  kontextual  r weightQuantile inhom #> 1        1 p53+Tumour__Immune -16.80697 -11.7627530 50            0.8  TRUE #> 2       14 p53+Tumour__Immune -12.04180  -1.2918308 50            0.8  TRUE #> 3       18 p53+Tumour__Immune  -1.84683   0.3924011 50            0.8  TRUE #> 4       21 p53+Tumour__Immune -13.52433  -8.1127627 50            0.8  TRUE #> 5       29 p53+Tumour__Immune -20.64993 -12.7124791 50            0.8  TRUE #> 6        3 p53+Tumour__Immune -21.83492  -5.9727237 50            0.8  TRUE #> 7       32 p53+Tumour__Immune -16.65927  16.4366555 50            0.8  TRUE #> 8       35 p53+Tumour__Immune -50.00000 -50.0000000 50            0.8  TRUE #> 9        5 p53+Tumour__Immune        NA          NA 50            0.8  TRUE #> 10       6 p53+Tumour__Immune -22.00997   5.2417206 50            0.8  TRUE #>     edge includeZeroCells window window.length #> 1  FALSE             TRUE convex            NA #> 2  FALSE             TRUE convex            NA #> 3  FALSE             TRUE convex            NA #> 4  FALSE             TRUE convex            NA #> 5  FALSE             TRUE convex            NA #> 6  FALSE             TRUE convex            NA #> 7  FALSE             TRUE convex            NA #> 8  FALSE             TRUE convex            NA #> 9  FALSE             TRUE convex            NA #> 10 FALSE             TRUE convex            NA # Get all relationships between cell types and their parents parentDf <- parentCombinations(   all = all,   tumour,   bcells,   tcells,   myeloid,   endothelial,   mesenchymal,   tissue,   immune ) # Running Kontextual on all relationships across all images. kerenKontextual <- Kontextual(   cells = kerenSCE,   parentDf = parentDf,   r = 50,   cores = nCores ) data(\"kerenKontextual\") head(kerenKontextual, 10) #>    imageID                      test   original kontextual  r weightQuantile #> 1        1 B__Keratin_Tumour__bcells -12.992212  14.433756 50            0.8 #> 2       14 B__Keratin_Tumour__bcells         NA         NA 50            0.8 #> 3       18 B__Keratin_Tumour__bcells  -4.475831  -2.032805 50            0.8 #> 4       21 B__Keratin_Tumour__bcells         NA         NA 50            0.8 #> 5       29 B__Keratin_Tumour__bcells         NA         NA 50            0.8 #> 6        3 B__Keratin_Tumour__bcells -22.725228  -1.330939 50            0.8 #> 7       32 B__Keratin_Tumour__bcells -25.427475  -9.672005 50            0.8 #> 8       35 B__Keratin_Tumour__bcells -36.867563 -16.313205 50            0.8 #> 9        5 B__Keratin_Tumour__bcells -26.894815  22.394483 50            0.8 #> 10       6 B__Keratin_Tumour__bcells -19.788448 -10.515649 50            0.8 #>    inhom  edge includeZeroCells window window.length #> 1   TRUE FALSE             TRUE convex            NA #> 2   TRUE FALSE             TRUE convex            NA #> 3   TRUE FALSE             TRUE convex            NA #> 4   TRUE FALSE             TRUE convex            NA #> 5   TRUE FALSE             TRUE convex            NA #> 6   TRUE FALSE             TRUE convex            NA #> 7   TRUE FALSE             TRUE convex            NA #> 8   TRUE FALSE             TRUE convex            NA #> 9   TRUE FALSE             TRUE convex            NA #> 10  TRUE FALSE             TRUE convex            NA"},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"examining-cell-to-cell-interactions-with-marker-expression","dir":"Articles","previous_headings":"","what":"Examining Cell-to-cell interactions with marker expression","title":"Statial","text":"next section vignette, utilise marker expression features Keren et al. dataset computationally identify quantify evidence cell interactions catalyse cell state changes. approach measures protein markers cell change spatial proximity abundance cell types. methods utilised provide framework explore dynamic behaviour cells altered agents surrounded . first step analysing changes calculate spatial proximity (getDistances) abundance (getAbundances) cell every cell type. values stored reducedDims slot SingleCellExperiment object names distances abundances respectively. First, let’s examine effect observed earlier Kontextual - localisation p53-positive keratin/tumour cells macrophages context total keratin/tumour cells image 6 Keren et al. dataset. Statial provides two main functions assess relationship - calcStateChanges plotStateChanges. can use calcStateChanges examine relationship 2 cell types 1 marker specific image. case, ’re examining relationship keratin/tumour cells (= Keratin_Tumour) macrophages (= \"Macrophages\") marker p53 (marker = \"p53\") image = \"6\". can appreciate fdr statistic relationship significant, negative tvalue, indicating expression p53 keratin/tumour cells decreases distance macrophages increases. Statial also provides convenient function visualising interaction - plotStateChanges. , can specify image = 6 main cell types interest, keratin/tumour cells macrophages, marker p53, format calcStateChanges. analysis, can observe keratin/tumour cells closer group macrophages tend higher expression p53, observed first graph. relationship quantified second graph, showing overall decrease p53 expression keratin/tumour cells distance macrophages increase. results allow us essentially arrive result Kontextual, calculated localisation p53+ keratin/tumour cells macrophages wider context keratin/tumour cells.  Beyond looking single cell--cell interactions single image, can also look interactions across images. calcStateChanges function provided Statial can expanded exact purpose - specifying cell types, marker, image, calcStateChanges examine significant correlations distance marker expression across entire dataset. , ’ve filtered significant interactions include found within image 6 Keren et al. dataset. Let’s take look top 10 significant gene--distance pairwise interactions. image 6, majority top 10 significant interactions occur keratin/tumour cells immune population, many interactions appear involve HLA class ligand. can examine interactions plotStateChanges function. Taking closer examination relationship macrophages keratin/tumour HLA class expression, plot shows us clear visual correlation - macrophage density increases, keratin/tumour cells increase expression HLA class . Biologically, HLA Class ligand exists nucleated cells, tasked presenting internal cell antigens recognition immune system, marking aberrant cells destruction either CD8+ T cells NK cells. increased expression HLA Class molecules tumour cells interesting finding, potentially uncovers novel interaction tumour cells macrophages drives aberrant HLA Class expression tumour cells.   Now, can take look top 10 significant results across images. Immediately, can appreciate couple interactions appear bit strange. One significant interactions occurs B cells CD4 T cells, CD4 T cells found increase CD20 expression close proximity B cells. Biologically, CD20 highly specific ligand B cells, healthy circumstances usually expressed T cells. potentially artefact calcStateChanges? can examine image plotStateChanges function, indeed observe strong increase CD20 expression T cells nearby B cell populations.   T cells expressing CD20? brings us key problem cell segmentation - contamination.","code":"kerenSCE <- getDistances(kerenSCE,                     maxDist = 200,                     nCores = 1)  kerenSCE <- getAbundances(kerenSCE,                      r = 200,                      nCores = 1) stateChanges <- calcStateChanges(   cells = kerenSCE,   type = \"distances\",   image = \"6\",   from = \"Keratin_Tumour\",   to = \"Macrophages\",   marker = \"p53\",   nCores = 1)  stateChanges #>   imageID primaryCellType otherCellType marker         coef      tval #> 1       6  Keratin_Tumour   Macrophages    p53 -0.001402178 -7.010113 #>           pval          fdr #> 1 2.868257e-12 2.868257e-12 p <- plotStateChanges(   cells = kerenSCE,   type = \"distances\",   image = \"6\",   from = \"Keratin_Tumour\",   to = \"Macrophages\",   marker = \"p53\",   size = 1,   shape = 19,   interactive = FALSE,   plotModelFit = FALSE,   method = \"lm\")  p #> $image #>  #> $scatter #> `geom_smooth()` using formula = 'y ~ x' stateChanges <- calcStateChanges(   cells = kerenSCE,   type = \"distances\",   nCores = 1,   minCells = 100)  stateChanges |> head(n = 10) #>      imageID primaryCellType otherCellType     marker         coef      tval #> 8674      35        CD4_Cell             B       CD20 -0.029185750 -40.57355 #> 8770      35        CD4_Cell       Dc/Mono       CD20  0.019125946  40.53436 #> 1819      35               B       Dc/Mono phospho.S6  0.005282065  40.41385 #> 8779      35        CD4_Cell       Dc/Mono phospho.S6  0.004033218  34.72882 #> 1813      35               B       Dc/Mono     HLA.DR  0.011120703  34.15344 #> 1971      35               B  other immune          P  0.011182182  34.14375 #> 8626      35        CD4_Cell      CD3_Cell       CD20  0.016349492  33.91901 #> 1816      35               B       Dc/Mono     H3K9ac  0.005096632  33.99856 #> 2011      35               B  other immune phospho.S6  0.005986586  33.66466 #> 1818      35               B       Dc/Mono   H3K27me3  0.006980810  33.22740 #>               pval           fdr #> 8674 7.019343e-282 3.516340e-277 #> 8770 1.891267e-281 4.737152e-277 #> 1819 5.306590e-278 8.861121e-274 #> 8779 4.519947e-219 5.660669e-215 #> 1813 8.401034e-212 8.416996e-208 #> 1971 1.056403e-211 8.820085e-208 #> 8626 1.219488e-210 8.727177e-207 #> 1816 3.266533e-210 2.045462e-206 #> 2011 8.545691e-207 4.756627e-203 #> 1818 2.438769e-202 1.221701e-198  stateChanges |>    filter(imageID == 6) |>   head(n = 10) #>    imageID primaryCellType otherCellType       marker         coef      tval #> 1        6  Keratin_Tumour  Unidentified           Na  0.004218419  25.03039 #> 2        6  Keratin_Tumour   Macrophages  HLA_Class_1 -0.003823497 -24.69629 #> 3        6  Keratin_Tumour      CD4_Cell  HLA_Class_1 -0.003582774 -23.87797 #> 4        6  Keratin_Tumour  Unidentified Beta.catenin  0.005893120  23.41953 #> 5        6  Keratin_Tumour      CD8_Cell  HLA_Class_1 -0.003154544 -23.13804 #> 6        6  Keratin_Tumour       Dc/Mono  HLA_Class_1 -0.003353834 -22.98944 #> 7        6  Keratin_Tumour      CD3_Cell  HLA_Class_1 -0.003123446 -22.63197 #> 8        6  Keratin_Tumour        Tumour  HLA_Class_1  0.003684079  21.94265 #> 9        6  Keratin_Tumour      CD4_Cell           Fe -0.003457338 -21.43550 #> 10       6  Keratin_Tumour      CD4_Cell   phospho.S6 -0.002892457 -20.50767 #>             pval           fdr #> 1  6.971648e-127 1.164149e-123 #> 2  7.814253e-124 1.223297e-120 #> 3  1.745242e-116 2.185698e-113 #> 4  1.917245e-112 2.233591e-109 #> 5  5.444541e-110 5.929224e-107 #> 6  1.053130e-108 1.099094e-105 #> 7  1.237988e-105 1.192634e-102 #> 8  8.188258e-100  6.952386e-97 #> 9   1.287478e-95  9.626298e-93 #> 10  3.928912e-88  2.556089e-85 p <- plotStateChanges(   cells = kerenSCE,   type = \"distances\",   image = \"6\",   from = \"Keratin_Tumour\",   to = \"Macrophages\",   marker = \"HLA_Class_1\",   size = 1,   shape = 19,   interactive = FALSE,   plotModelFit = FALSE,   method = \"lm\")  p #> $image #>  #> $scatter #> `geom_smooth()` using formula = 'y ~ x' #> Warning: Removed 1359 rows containing non-finite values #> (`stat_smooth()`). #> Warning: Removed 1359 rows containing missing values (`geom_point()`). p <- plotStateChanges(   cells = kerenSCE,   type = \"distances\",   image = \"35\",   from = \"CD4_Cell\",   to = \"B\",   marker = \"CD20\",   size = 1,   shape = 19,   interactive = FALSE,   plotModelFit = FALSE,   method = \"lm\")  p #> $image #>  #> $scatter #> `geom_smooth()` using formula = 'y ~ x' #> Warning: Removed 26 rows containing missing values (`geom_smooth()`)."},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"contamination","dir":"Articles","previous_headings":"","what":"Contamination","title":"Statial","text":"Contamination, lateral marker spill issue results cell’s marker expressions wrongly attributed another adjacent cell. issue arises incorrect segmentation components one cell wrongly determined belonging another cell. Alternatively, issue can arise antibodies used tag measure marker expressions don’t latch properly cell interest, thereby resulting residual markers wrongly assigned belonging cell near intended target cell. important either correct account incorrect attribution markers modelling process. critical understanding whether significant cell-cell interactions detected artefact technical measurement errors driven spill real biological changes represent shift cell’s state. circumvent problem, Statial provides function predicts probability cell particular cell type - calcContamination. calcContamination returns dataframe probabilities demarcating chance cell particular cell type. dataframe stored contaminations reducedDim slot SingleCellExperiment object. also provides rfMainCellProb column, provides probability cell indeed cell type designated. E.g. cell designated CD8, rfMainCellProb give 80% chance cell indeed CD8, due contamination. can introduce probabilities covariates linear model setting contamination = TRUE parameter calcStateChanges function. However, perfect solution issue contamination. can see, despite factoring contamination linear model, correlation B cell density CD20 expression CD4 T cells remains one significant interactions model. However, mean factoring contamination linear model ineffective. can visualise plotting ROC curve true positives false positives. general, cell type specific markers CD4, CD8, CD20 change cells specific . Therefore, relationships detected significant involving cell type markers likely false positives treated purposes evaluation. Meanwhile, cell state markers predominantly likely true positives. Plotting relationship false positives true positives, ’d expect contamination correction greatest relationships top 100 lowest p values, indeed see true positives false positives contamination correction.   next steps involve comparing survival time see distance--gene interactions biologically significant.","code":"kerenSCE <- calcContamination(kerenSCE)  stateChangesCorrected <- calcStateChanges(   cells = kerenSCE,   type = \"distances\",   nCores = 1,   minCells = 100,   contamination = TRUE)  stateChangesCorrected |> head(n = 20) #>       imageID primaryCellType otherCellType      marker         coef      tval #> 8674       35        CD4_Cell             B        CD20 -0.024053806 -34.16921 #> 8770       35        CD4_Cell       Dc/Mono        CD20  0.015338102  32.45341 #> 1819       35               B       Dc/Mono  phospho.S6  0.004268556  29.70870 #> 29188       3  Keratin_Tumour            DC          Ca -0.014133273 -29.91165 #> 8779       35        CD4_Cell       Dc/Mono  phospho.S6  0.003500300  28.56613 #> 8626       35        CD4_Cell      CD3_Cell        CD20  0.012957174  28.21901 #> 8629       35        CD4_Cell      CD3_Cell      HLA.DR  0.009827820  27.71040 #> 1669       35               B      CD3_Cell      HLA.DR  0.008943192  25.72528 #> 1813       35               B       Dc/Mono      HLA.DR  0.008871298  25.40413 #> 31825       6  Keratin_Tumour  Unidentified          Na  0.004193871  24.57325 #> 27641      21  Keratin_Tumour            DC Pan.Keratin -0.005816982 -24.19724 #> 2011       35               B  other immune  phospho.S6  0.004591992  24.75105 #> 8763       35        CD4_Cell       Dc/Mono      CSF.1R  0.008452988  24.33031 #> 1675       35               B      CD3_Cell  phospho.S6  0.003627102  24.19170 #> 1971       35               B  other immune           P  0.007692125  23.95945 #> 2008       35               B  other immune      H3K9ac  0.004761955  23.77237 #> 29186       3  Keratin_Tumour            DC          Si -0.005768766 -23.85713 #> 8635       35        CD4_Cell      CD3_Cell  phospho.S6  0.002817871  23.60516 #> 1816       35               B       Dc/Mono      H3K9ac  0.003775457  23.29259 #> 31918       6  Keratin_Tumour   Macrophages HLA_Class_1 -0.003400397 -22.46361 #>                pval           fdr #> 8674  4.879116e-213 2.444193e-208 #> 8770  2.012825e-195 5.041623e-191 #> 1819  2.750369e-167 4.592658e-163 #> 29188 1.365443e-165 1.710047e-161 #> 8779  4.357205e-157 4.365483e-153 #> 8626  8.726283e-154 7.285719e-150 #> 8629  5.477451e-149 3.919899e-145 #> 1669  3.066757e-130 1.920365e-126 #> 1813  2.195400e-127 1.221984e-123 #> 31825 1.133784e-122 5.679690e-119 #> 27641 5.085731e-122 2.316088e-118 #> 2011  1.202310e-121 5.019142e-118 #> 8763  2.064336e-118 7.954839e-115 #> 1675  8.344853e-117 2.985967e-113 #> 1971  8.151893e-115 2.722461e-111 #> 2008  3.200374e-113 1.002017e-109 #> 29186 3.099028e-112 9.132107e-109 #> 8635  3.559022e-112 9.904955e-109 #> 1816  3.598182e-109 9.486890e-106 #> 31918 3.627068e-104 9.084898e-101 cellTypeMarkers <- c(\"CD3\", \"CD4\", \"CD8\", \"CD56\", \"CD11c\", \"CD68\", \"CD45\", \"CD20\")  values = c(\"blue\", \"red\") names(values) <- c(\"None\", \"Corrected\")  df <- rbind(data.frame(TP =cumsum(stateChanges$marker %in% cellTypeMarkers), FP = cumsum(!stateChanges$marker %in% cellTypeMarkers), type = \"None\"),             data.frame(TP =cumsum(stateChangesCorrected$marker %in% cellTypeMarkers), FP = cumsum(!stateChangesCorrected$marker %in% cellTypeMarkers), type = \"Corrected\"))  ggplot(df, aes(x = TP, y = FP, colour = type)) + geom_line()+ labs(y = \"Cell state marker\", x = \"Cell type marker\") + scale_colour_manual(values = values) ggplot(df, aes(x = TP, y = FP, colour = type)) + geom_line()+ xlim(0,100) + ylim(0,1000)+ labs(y = \"Cell state marker\", x = \"Cell type marker\") + scale_colour_manual(values = values) #> Warning: Removed 99810 rows containing missing values (`geom_line()`)."},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"relating-statial-features-to-patient-groups-or-outcomes-","dir":"Articles","previous_headings":"","what":"Relating Statial features to patient groups or outcomes.","title":"Statial","text":"examine whether features obtained Statial associated patient outcomes groupings, ’ve provided helper function coxTests understand survival outcomes differ significantly 2 patient groups. examine features associated patient survival using Kontextual values example. , survival data extracted kerenSCE converted survival object, kerenSurv. addition , Kontextual results must converted data.frame wide matrix, can done using prepMatrix. Note, extract original L-function values, specify column = \"original\" prepMatrix. Finally, Kontextual matrix survival object passed coxTests obtain survival results. can see results Mesenchymal__other immune__tissue significant pairwise relationship contributes patient survival. relationship Mesenchymal cells immune cells, relative parent population tissue cells. can see positive coeffcient associated relationship, tells us increase localisation Mesenchymal Macrophages lead poorer survival outcomes patients. association Mesenchymal__other immune__tissue survival can also visualised Kaplan-Meier curve. must first extract Kontextual values relationship across images. Next determine Mesenchymal Macrophages relatively attracted avoiding image, comparing Kontextual value image median Kontextual value. Finally plot Kaplan-Meier curve using ggsurvfit package. shown , Mesenchymal Macrophages relatively dispersed one another, patients tend better survival outcomes. cells relatively localised, patients poorer survival outcome.  Similar survival analysis can done using state changes results. , prepMatrix extracts coefficients, coef column stateChanges default. use t values instead, specify column = \"tval\" prepMatrix function. state changes results, Keratin_Tumour__CD4_Cell__Keratin6 significant pairwise relationship contributes patient survival. relationship Keratin6 expressing keratin/tumour cells CD4 cells. can see positive coeffcient associated relationship, tells us higher Keratin6 keratin/tumour cells nearby CD4 populations lead poorer survival outcomes patients. , can also visualise Kaplan-Meier curve visualisation significant interaction. Kontextual calcStateChanges provides different outputs, localisation refers increased localisation Keratin6 expressing keratin/tumour cells CD4 cells, .e. localisation means keratin/tumour cells tend increase Keratin6 expression nearby CD4 cells, whilst dispersion mean keratin/tumour cells tend express Keratin6 near CD4 cell populations. shown , increased keratin6 expression keratin/tumour cells near CD4 populations tends worsen survival outcomes, whilst lower keratin6 expression appears improve survival outcomes.","code":"# Helper function to run coxPh models  coxTests = function(measurementMat, Surv) {      result = apply(measurementMat, 2, function(measurementCol) {     fit = coxph(Surv ~ measurementCol)     summary(fit)$coefficients[1, c(1, 3, 5)]   })      result = result |>      t() |>      data.frame() |>      rownames_to_column()       colnames(result) = c(\"imageID\", \"coef\", \"se.coef\", \"p.value\")   result$`adj.p.value` = p.adjust(result$`p.value`, \"fdr\")      result = result |> arrange(p.value)      result[,sapply(result,is.numeric)] <- signif(result[,sapply(result,is.numeric)],2)      return(result) } # Extracting survival data to create survival object survData = kerenSCE |>     colData() |>      data.frame() |>      select(imageID, Survival_days_capped, Censored) |>      unique()  # Creating survival vector kerenSurv = Surv(survData$Survival_days_capped, survData$Censored) names(kerenSurv) = survData$imageID   # Converting Kontextual result into data matrix kontextMat = prepMatrix(kerenKontextual)  # Ensuring rownames of kontextMat match up with rownames of the survival vector  kontextMat = kontextMat[names(kerenSurv), ]   # Running survival analysis survivalResults = coxTests(kontextMat, kerenSurv) #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  head(survivalResults) #>                               imageID   coef se.coef p.value adj.p.value #> 1   Mesenchymal__other immune__tissue  0.096   0.048   0.044        0.64 #> 2  other immune__Endothelial__myeloid  0.047   0.024   0.049        0.64 #> 3       CD4_Cell__Neutrophils__immune  0.110   0.055   0.050        0.64 #> 4          CD4_Cell__CD8_Cell__tcells  0.580   0.300   0.050        0.64 #> 5    CD4_Cell__Keratin_Tumour__immune -0.150   0.075   0.051        0.64 #> 6 Neutrophils__Keratin_Tumour__immune  0.100   0.053   0.053        0.64 # Selecting most significant relationship survRelationship = kontextMat[[\"Mesenchymal__other immune__tissue\"]] survRelationship = ifelse(survRelationship > median(survRelationship), \"Localised\", \"Dispersed\")      # Plotting Kaplan-Meier curve survfit2(kerenSurv ~ survRelationship) |>     ggsurvfit() +     add_pvalue() +     ggtitle(\"Mesenchymal__other immune__tissue\") #Preparing features for Statial stateMat <- prepMatrix(stateChanges)  # Ensuring rownames of stateMat match up with rownames of the survival vector  stateMat = stateMat[names(kerenSurv), ]  survivalResults = coxTests(stateMat, kerenSurv) #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  head(survivalResults) #>                            imageID  coef se.coef p.value adj.p.value #> 1 CD4_Cell__other immune__Vimentin  1600     760   0.032        0.76 #> 2      CD4_Cell__Macrophages__CD68  -250     120   0.033        0.76 #> 3                  Dc/Mono__B__CD4 -1000     470   0.034        0.76 #> 4         CD4_Cell__CD4_Cell__CD16   910     430   0.034        0.76 #> 5             Dc/Mono__Tregs__CD45 -1500     690   0.034        0.76 #> 6         CD4_Cell__CD8_Cell__CD68  1400     650   0.036        0.76 survRelationship = stateMat[[\"Keratin_Tumour__CD4_Cell__Keratin6\"]] survRelationship = ifelse(survRelationship > median(survRelationship), \"Dispersed\", \"Localised\")      # Plotting Kaplan-Meier curve survfit2(kerenSurv ~ survRelationship) |>     ggsurvfit() +     add_pvalue() +     ggtitle(\"Keratin_Tumour__CD4_Cell__Keratin6\")"},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"region-analysis-using-lisaclust","dir":"Articles","previous_headings":"","what":"Region analysis using lisaClust","title":"Statial","text":"Next can cluster areas similar spatial interactions identify regions using lisaClust. set k = 5 identify 5 regions. regions identified licaClust can visualised using hatchingPlot function.","code":"set.seed(51773)  # Preparing features for lisaClust kerenSCE <- lisaClust::lisaClust(kerenSCE, k = 5) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'. # Use hatching to visualise regions and cell types. lisaClust::hatchingPlot(kerenSCE,   useImages = \"5\",   line.spacing = 41, # spacing of lines   nbp = 100 # smoothness of lines )  #> There is no cellID. I'll create these #> There is no image specific imageCellID. I'll create these #> Creating variable region #> Concave windows are temperamental. Try choosing values of window.length > and < 1 if you have problems."},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"marker-means","dir":"Articles","previous_headings":"","what":"Marker Means","title":"Statial","text":"Statial provides functionality identify average marker expression given cell type given region, using getMarkerMeans function. Similar analysis , features can also used survival analysis.","code":"cellTypeRegionMeans <- getMarkerMeans(kerenSCE,                               imageID = \"imageID\",                               cellType = \"cellType\",                               region = \"region\")  survivalResults = coxTests(cellTypeRegionMeans[names(kerenSurv),], kerenSurv) #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Loglik converged before variable 1 ; coefficient may be infinite.  head(survivalResults) #>                          imageID coef se.coef p.value adj.p.value #> 1      CD45RO__Dc/Mono__region_3  2.6     1.2   0.028        0.83 #> 2       CD11b__Dc/Mono__region_3  7.8     3.6   0.031        0.83 #> 3 HLA_Class_1__Dc/Mono__region_5  3.4     1.6   0.031        0.83 #> 4        HLA.DR__Tregs__region_3  3.6     1.7   0.032        0.83 #> 5        CD68__Dc/Mono__region_3  6.9     3.2   0.033        0.83 #> 6  HLA.DR__Mesenchymal__region_4  6.8     3.2   0.033        0.83"},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"patient-classification","dir":"Articles","previous_headings":"","what":"Patient classification","title":"Statial","text":"Finally demonstrate can use ClassifyR perform patient classification features generated Statial. addition kontextual, state changes, marker means values, also calculate cell type proportions region proportions using getProp function spicyR. perform 3 fold cross validation 10 repeats, using CoxPH model survival classification, feature selection also performed selecting top 10 features per fold using CoxPH model. , use performancePlot function assess C-index repeat 3-fold cross-validation. can see resulting C-indexes variable due dataset containing 10 images.","code":"# Calculate cell type and region proportions cellTypeProp <- getProp(kerenSCE,                         feature = \"cellType\",                        imageID = \"imageID\") regionProp <- getProp(kerenSCE,                         feature = \"region\",                        imageID = \"imageID\")  # Combine all the features into a list for classification  featureList <- list(states = stateMat,                       kontextual = kontextMat,                      regionMarkerMeans = cellTypeRegionMeans,                      cellTypeProp = cellTypeProp,                      regionProp = regionProp)  # Ensure the rownames of the features match the order of the survival vector featureList <- lapply(featureList, function(x)x[names(kerenSurv),])   set.seed(51773)  kerenCV = crossValidate(   measurements = featureList,   outcome = kerenSurv,   classifier = \"CoxPH\",   selectionMethod  = \"CoxPH\",   nFolds = 3,   nFeatures = 10,   nRepeats = 20,   nCores = 1   ) #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> one or more coefficients may be infinite #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge #> Warning in .local(measurements, ...): 1 cross-validations, but not all, had an #> error and have been removed from the results. #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge  #> Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, : #> Ran out of iterations and did not converge # Calculate AUC for each cross-validation repeat and plot. performancePlot(kerenCV,   characteristicsList = list(x = \"Assay Name\")   ) +    theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) #> Warning in .local(results, ...): C-index not found in all elements of results. #> Calculating it now."},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Statial","text":"Keren, L., Bosse, M., Marquez, D., Angoshtari, R., Jain, S., Varma, S., Yang, S. R., Kurian, ., Van Valen, D., West, R., Bendall, S. C., & Angelo, M. (2018). Structured Tumor-Immune Microenvironment Triple Negative Breast Cancer Revealed Multiplexed Ion Beam Imaging. Cell, 174(6), 1373-1387.e1319. (DOI)","code":""},{"path":"https://sydneybiox.github.io/Statial/articles/Statial.html","id":"sessioninfo","dir":"Articles","previous_headings":"","what":"sessionInfo","title":"Statial","text":"","code":"sessionInfo() #> R version 4.3.1 (2023-06-16) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Debian GNU/Linux 12 (bookworm) #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.21.so;  LAPACK version 3.11.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: Australia/Sydney #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] tibble_3.2.1                ggsurvfit_0.3.0             #>  [3] ggplot2_3.4.2               SingleCellExperiment_1.23.0 #>  [5] dplyr_1.1.2                 lisaClust_1.9.0             #>  [7] ClassifyR_3.5.8             survival_3.5-5              #>  [9] BiocParallel_1.35.3         MultiAssayExperiment_1.27.0 #> [11] SummarizedExperiment_1.31.1 Biobase_2.61.0              #> [13] GenomicRanges_1.53.1        GenomeInfoDb_1.37.2         #> [15] IRanges_2.35.2              MatrixGenerics_1.13.1       #> [17] matrixStats_1.0.0           S4Vectors_0.39.1            #> [19] BiocGenerics_0.47.0         generics_0.1.3              #> [21] spicyR_1.13.1               Statial_1.2.1               #> [23] BiocStyle_2.29.1            #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3        jsonlite_1.8.7            #>   [3] magrittr_2.0.3            spatstat.utils_3.0-3      #>   [5] magick_2.7.4              farver_2.1.1              #>   [7] nloptr_2.0.3              rmarkdown_2.23            #>   [9] fs_1.6.3                  zlibbioc_1.47.0           #>  [11] ragg_1.2.5                vctrs_0.6.3               #>  [13] spatstat.explore_3.2-1    memoise_2.0.1             #>  [15] minqa_1.2.5               DelayedMatrixStats_1.23.0 #>  [17] RCurl_1.98-1.12           rstatix_0.7.2             #>  [19] htmltools_0.5.5           S4Arrays_1.1.5            #>  [21] curl_5.0.1                broom_1.0.5               #>  [23] Rhdf5lib_1.23.0           SparseArray_1.1.11        #>  [25] rhdf5_2.45.1              sass_0.4.7                #>  [27] bslib_0.5.0               htmlwidgets_1.6.2         #>  [29] desc_1.4.2                plyr_1.8.8                #>  [31] plotly_4.10.2             cachem_1.0.8              #>  [33] lifecycle_1.0.3           pkgconfig_2.0.3           #>  [35] Matrix_1.5-3              R6_2.5.1                  #>  [37] fastmap_1.1.1             GenomeInfoDbData_1.2.10   #>  [39] digest_0.6.33             numDeriv_2016.8-1.1       #>  [41] colorspace_2.1-0          tensor_1.5                #>  [43] rprojroot_2.0.3           dqrng_0.3.0               #>  [45] textshaping_0.3.6         ggpubr_0.6.0              #>  [47] beachmat_2.17.14          labeling_0.4.2            #>  [49] spatstat.sparse_3.0-2     fansi_1.0.4               #>  [51] httr_1.4.6                polyclip_1.10-4           #>  [53] abind_1.4-5               mgcv_1.9-0                #>  [55] compiler_4.3.1            withr_2.5.0               #>  [57] backports_1.4.1           carData_3.0-5             #>  [59] highr_0.10                HDF5Array_1.29.3          #>  [61] ggforce_0.4.1             R.utils_2.12.2            #>  [63] ggsignif_0.6.4            MASS_7.3-60               #>  [65] concaveman_1.1.0          DelayedArray_0.27.10      #>  [67] rjson_0.2.21              tools_4.3.1               #>  [69] ranger_0.15.1             goftest_1.2-3             #>  [71] R.oo_1.25.0               glue_1.6.2                #>  [73] nlme_3.1-162              rhdf5filters_1.13.5       #>  [75] grid_4.3.1                reshape2_1.4.4            #>  [77] gtable_0.3.3              spatstat.data_3.0-1       #>  [79] class_7.3-22              R.methodsS3_1.8.2         #>  [81] tidyr_1.3.0               data.table_1.14.8         #>  [83] car_3.1-2                 utf8_1.2.3                #>  [85] XVector_0.41.1            spatstat.geom_3.2-4       #>  [87] pillar_1.9.0              stringr_1.5.0             #>  [89] limma_3.57.7              splines_4.3.1             #>  [91] tweenr_2.0.2              lattice_0.21-8            #>  [93] deldir_1.0-9              tidyselect_1.2.0          #>  [95] locfit_1.5-9.8            scuttle_1.11.2            #>  [97] knitr_1.43                V8_4.3.3                  #>  [99] bookdown_0.34             edgeR_3.43.8              #> [101] xfun_0.39                 statmod_1.5.0             #> [103] DropletUtils_1.21.0       pheatmap_1.0.12           #> [105] fftwtools_0.9-11          scam_1.2-14               #> [107] stringi_1.7.12            lazyeval_0.2.2            #> [109] yaml_2.3.7                boot_1.3-28.1             #> [111] evaluate_0.21             codetools_0.2-19          #> [113] BiocManager_1.30.21.1     cli_3.6.1                 #> [115] systemfonts_1.0.4         munsell_0.5.0             #> [117] jquerylib_0.1.4           Rcpp_1.0.11               #> [119] spatstat.random_3.1-5     parallel_4.3.1            #> [121] pkgdown_2.0.7             sparseMatrixStats_1.13.0  #> [123] bitops_1.0-7              lme4_1.1-34               #> [125] SpatialExperiment_1.11.0  viridisLite_0.4.2         #> [127] lmerTest_3.1-3            scales_1.2.1              #> [129] purrr_1.0.1               crayon_1.5.2              #> [131] rlang_1.1.1"},{"path":"https://sydneybiox.github.io/Statial/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Farhan Ameen. Author, maintainer. Sourish Iyengar. Author. Shila Ghazanfar. Author. Ellis Patrick. Author.","code":""},{"path":"https://sydneybiox.github.io/Statial/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ameen F, Iyengar S, Ghazanfar S, Patrick E (2023). Statial: package identify changes cell state relative spatial associations. https://sydneybiox.github.io/Statial https://github.com/SydneyBioX/Statial/issues.","code":"@Manual{,   title = {Statial: A package to identify changes in cell state relative to spatial associations},   author = {Farhan Ameen and Sourish Iyengar and Shila Ghazanfar and Ellis Patrick},   year = {2023},   note = {https://sydneybiox.github.io/Statial https://github.com/SydneyBioX/Statial/issues}, }"},{"path":[]},{"path":"https://sydneybiox.github.io/Statial/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"A package to identify changes in cell state relative to spatial associations","text":"Statial suite functions identifying changes cell state. functionality provided Statial provides robust quantification cell type localisation invariant changes tissue structure. addition Statial uncovers changes marker expression associated varying levels localisation. features can used explore structure function different cell types may altered agents surrounded .","code":""},{"path":"https://sydneybiox.github.io/Statial/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"A package to identify changes in cell state relative to spatial associations","text":"Installing package Bioconductor. Otherwise, install development version GitHub.","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") }  BiocManager::install(\"Statial\") # Install the development version from GitHub: # install.packages(\"devtools\") devtools::install_github(\"SydneyBioX/Statial\") library(Statial)"},{"path":"https://sydneybiox.github.io/Statial/index.html","id":"submitting-an-issue-or-feature-request","dir":"","previous_headings":"Installation","what":"Submitting an issue or feature request","title":"A package to identify changes in cell state relative to spatial associations","text":"Statial still active development. greatly appreciate feedback related package. R package related issues raised . general questions feedback, please contact us directly via ellis.patrick@sydney.edu.au.","code":""},{"path":"https://sydneybiox.github.io/Statial/index.html","id":"author","dir":"","previous_headings":"","what":"Author","title":"A package to identify changes in cell state relative to spatial associations","text":"Farhan Ameen Sourish Iyengar Shila Ghazanfar - @shazanfar Ellis Patrick - @TheEllisPatrick","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/Konditional.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"Kontextual identifies relationship two cell types  conditional spatial behaviour 3rd cell population,  particular radius (r).","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/Konditional.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"","code":"Kontextual(   cells,   parentDf = NULL,   r,   from = NULL,   to = NULL,   parent = NULL,   inhom = TRUE,   edgeCorrect = FALSE,   window = \"convex\",   window.length = NA,   weightQuantile = 0.8,   includeZeroCells = TRUE,   includeOriginal = TRUE,   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   imageID = \"imageID\",   cores = 1 )"},{"path":"https://sydneybiox.github.io/Statial/reference/Konditional.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"cells SingleCellExperiment, SpatialExperiment list  data.frames containing columns specifying imageID, cellType, x y  spatial coordinates. parentDf data frame parentCombinations r Radius evaluated pairwise relationships cells. first cell type evaluated pairwise relationship. second cell type evaluated pairwise relationship. parent parent population cell type (must include cell type). inhom logical value indicating whether account inhomogeneity. edgeCorrect logical value indicating whether perform edge correction. window Type window data, either `square`, `convex` `concave`, passed makeWindow window.length tuning parameter controlling level concavity estimating concave windows. Passed makeWindow weightQuantile decimal value indicating quantile parent density used weight `` cells. includeZeroCells logical value indicating whether include cells zero counts pairwise association calculation. includeOriginal logical value return original L function values along kontextual values. spatialCoords columns contain x y spatial coordinates. cellType column contains cell types. imageID column contains image identifiers. cores Number cores parallel processing.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/Konditional.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"Koditional result object","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/Konditional.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"","code":"# Load data data(\"headSCE\")  CD4_Kontextual <- Kontextual(   cells = headSCE,   r = 50,   from = \"TC_CD4\",   to = \"SC5\",   parent = c(\"TC_CD4\", \"TC_CD8\"),   cores = 40 )   head(CD4_Kontextual) #>   imageID        test  original kontextual  r weightQuantile inhom  edge #> 1       1 TC_CD4__SC5 -11.50459    -1.94470 50            0.8  TRUE FALSE #> 2       5 TC_CD4__SC5 -15.07237     1.37433 50            0.8  TRUE FALSE #> 3       6 TC_CD4__SC5 -16.45579    12.28765 50            0.8  TRUE FALSE #> 4       7 TC_CD4__SC5 -17.68033   -11.51087 50            0.8  TRUE FALSE #> 5       8 TC_CD4__SC5 -15.78141    11.89574 50            0.8  TRUE FALSE #>   includeZeroCells window window.length #> 1             TRUE convex            NA #> 2             TRUE convex            NA #> 3             TRUE convex            NA #> 4             TRUE convex            NA #> 5             TRUE convex            NA"},{"path":"https://sydneybiox.github.io/Statial/reference/Kontextual.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"Kontextual identifies relationship two cell types  conditional spatial behaviour 3rd cell population,  particular radius (r).","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/Kontextual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"","code":"Kontextual(   cells,   r,   parentDf = NULL,   from = NULL,   to = NULL,   parent = NULL,   image = NULL,   inhom = TRUE,   edgeCorrect = FALSE,   window = \"convex\",   window.length = NA,   weightQuantile = 0.8,   includeZeroCells = TRUE,   includeOriginal = TRUE,   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   imageID = \"imageID\",   cores = 1 )"},{"path":"https://sydneybiox.github.io/Statial/reference/Kontextual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"cells SingleCellExperiment, SpatialExperiment list data.frames containing columns specifying imageID, cellType, x y spatial coordinates. r Radii evaluated pairwise relationships cells. parentDf data frame parentCombinations first cell type evaluated pairwise relationship. second cell type evaluated pairwise relationship. parent parent population cell type (must include cell type). image vector images filter results . inhom logical value indicating whether account inhomogeneity. edgeCorrect logical value indicating whether perform edge correction. window Type window data, either `square`, `convex` `concave`, passed makeWindow window.length tuning parameter controlling level concavity estimating concave windows. Passed makeWindow weightQuantile decimal value indicating quantile parent density used weight `` cells. includeZeroCells logical value indicating whether include cells zero counts pairwise association calculation. includeOriginal logical value return original L function values along kontextual values. spatialCoords columns contain x y spatial coordinates. cellType column contains cell types. imageID column contains image identifiers. cores Number cores parallel processing.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/Kontextual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"kontextualResult object","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/Kontextual.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluation of pairwise cell relationships, conditional on a 3rd population. — Kontextual","text":"","code":"# Load data data(\"kerenSCE\")   CD4_Kontextual <- Kontextual(   cells = kerenSCE,   r = 50,   from = \"Macrophages\",   to = \"Keratin_Tumour\",   parent = c(\"Macrophages\", \"CD4_Cell\"),   image = \"6\" )   head(CD4_Kontextual) #>   imageID                        test  original kontextual  r weightQuantile #> 1       6 Macrophages__Keratin_Tumour -26.12355   1.917272 50            0.8 #>   inhom  edge includeZeroCells window window.length #> 1  TRUE FALSE             TRUE convex            NA"},{"path":"https://sydneybiox.github.io/Statial/reference/calcContamination.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the level of marker contamination of each cell — calcContamination","title":"Calculate the level of marker contamination of each cell — calcContamination","text":"Calculates contamination scores using random forest classification","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/calcContamination.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the level of marker contamination of each cell — calcContamination","text":"","code":"calcContamination(   cells,   markers = NULL,   num.trees = 100,   verbose = FALSE,   missingReplacement = 0,   redDimName = \"contaminations\" )"},{"path":"https://sydneybiox.github.io/Statial/reference/calcContamination.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the level of marker contamination of each cell — calcContamination","text":"cells SingleCellExperiment SpatialExperiment cellType column well marker intensity information corresponding cell. markers vector markers proxy cell's state. NULL, markers  used. num.trees Number trees used random forest classifier verbose logical indicating whether information final random forest model outputted. missingReplacement default value replace missing marker intensities classification. redDimName redDimName store output sce.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/calcContamination.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the level of marker contamination of each cell — calcContamination","text":"","code":"data(\"kerenSCE\")  singleCellDataDistancesContam <- calcContamination(   kerenSCE )"},{"path":"https://sydneybiox.github.io/Statial/reference/calcStateChanges.html","id":null,"dir":"Reference","previous_headings":"","what":"First layer wrapper function to build linear models measuring state changes — calcStateChanges","title":"First layer wrapper function to build linear models measuring state changes — calcStateChanges","text":"Builds linear models measuring marker based state changes cell type based proximity abundance another cell type. function provides option build robust mixed linear model variants","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/calcStateChanges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"First layer wrapper function to build linear models measuring state changes — calcStateChanges","text":"","code":"calcStateChanges(   cells,   marker = NULL,   from = NULL,   to = NULL,   image = NULL,   type = \"distances\",   assay = 1,   cellType = \"cellType\",   imageID = \"imageID\",   contamination = NULL,   minCells = 20,   verbose = FALSE,   timeout = 10,   nCores = 1 )"},{"path":"https://sydneybiox.github.io/Statial/reference/calcStateChanges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"First layer wrapper function to build linear models measuring state changes — calcStateChanges","text":"cells dataframe imageID, cellType, marker intensity column along covariates (e.g. distance abundance nearest cell type) model cell state changes marker vector markers proxy cell's state. NULL, markers  used. vector cell types use primary cells. NULL, cell types  used. vector cell types use interacting cells. NULL, cell types  used. image vector images filter . null images used. type type state change. value reduced dimensions. assay assay sce contains marker expressions. cellType column colData stores cell types. imageID column colData stores image ids. contamination TRUE, use contamination scores previously calculate. Otherwise name reduced dimension contains scores. minCells minimum number cells required fit model. verbose logical indicating messages printed timeout maximum time allowed build model. Setting may important building rlm mixed linear models nCores Number cores parallel processing","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/calcStateChanges.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"First layer wrapper function to build linear models measuring state changes — calcStateChanges","text":"","code":"library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union data(\"kerenSCE\")  kerenSCE <- kerenSCE[, kerenSCE$imageID %in% c(5,6)]  kerenSCE <- getDistances(kerenSCE,   maxDist = 200, )  imageModels <- calcStateChanges(   cells = kerenSCE,   from = \"Macrophages\",   to = \"Tumour\" )"},{"path":"https://sydneybiox.github.io/Statial/reference/distanceCalculator.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate pairwise distance between cell types — distanceCalculator","title":"Calculate pairwise distance between cell types — distanceCalculator","text":"Calculates euclidean distance cell nearest cell type single image","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/distanceCalculator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate pairwise distance between cell types — distanceCalculator","text":"","code":"distanceCalculator(data, maxDist = 200, distFun = \"min\")"},{"path":"https://sydneybiox.github.io/Statial/reference/distanceCalculator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate pairwise distance between cell types — distanceCalculator","text":"data single cell data interest maxDist Maximum distance pairs points counted close pairs. distFun merge duplicate entries.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/getAbundances.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper to calculate imhomogenous K function between a cell and surrounding\ntypes on each image — getAbundances","title":"Wrapper to calculate imhomogenous K function between a cell and surrounding\ntypes on each image — getAbundances","text":"Calculate imhomogenous K function (measure cell type abundance) cell cell types","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/getAbundances.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper to calculate imhomogenous K function between a cell and surrounding\ntypes on each image — getAbundances","text":"","code":"getAbundances(   cells,   r = 200,   distFun = \"abundance\",   redDimName = \"abundances\",   cellType = \"cellType\",   imageID = \"imageID\",   spatialCoords = c(\"x\", \"y\"),   nCores = 1 )"},{"path":"https://sydneybiox.github.io/Statial/reference/getAbundances.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper to calculate imhomogenous K function between a cell and surrounding\ntypes on each image — getAbundances","text":"cells dataframe cellType column well x y spatial coordinates. dataframe must contain imageID column cellID (unique cell identifier's) column well r Radius include calculation pairwise abundance (K-function) cells (can numeric vector radii) distFun distance function use. redDimName Name reduced dimension store sce. cellType name column colData stores cell types. imageID name column colData Stores image ids. spatialCoords names columns colData store spatial coordinates. nCores Number cores parallel processing","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/getAbundances.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrapper to calculate imhomogenous K function between a cell and surrounding\ntypes on each image — getAbundances","text":"","code":"library(dplyr) data(\"kerenSCE\")  singleCellDataCounts <- getAbundances(kerenSCE,   r = 200, )"},{"path":"https://sydneybiox.github.io/Statial/reference/getDistances.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper to calculate pairwise distance between cell types by image — getDistances","title":"Wrapper to calculate pairwise distance between cell types by image — getDistances","text":"Calculates euclidean distance cell nearest cell type","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/getDistances.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper to calculate pairwise distance between cell types by image — getDistances","text":"","code":"getDistances(   cells,   maxDist = NULL,   imageID = \"imageID\",   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   redDimName = \"distances\",   distFun = \"min\",   nCores = 1 )"},{"path":"https://sydneybiox.github.io/Statial/reference/getDistances.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper to calculate pairwise distance between cell types by image — getDistances","text":"cells dataframe cellType column well x y spatial coordinates. dataframe must contain imageID column cellID (unique cell identifier's) column well maxDist maximum distance considered. imageID name colData column stores image ID. spatialCoords columns store spatial coordinates. cellType name colData column stores cell types. redDimName name reduced dimension store distances . distFun distance function use. Can min abundance. nCores Number cores parallel processing.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/getDistances.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrapper to calculate pairwise distance between cell types by image — getDistances","text":"","code":"data(\"kerenSCE\")  kerenSCE <- getDistances(kerenSCE,   maxDist = 200 )"},{"path":"https://sydneybiox.github.io/Statial/reference/getMarkerMeans.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the average expression for all markers for each cell type in each \nregion defined by lisaClust — getMarkerMeans","title":"Extract the average expression for all markers for each cell type in each \nregion defined by lisaClust — getMarkerMeans","text":"Takes SingleCellExperiment outputs dataframe convenient format  cross validation","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/getMarkerMeans.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the average expression for all markers for each cell type in each \nregion defined by lisaClust — getMarkerMeans","text":"","code":"getMarkerMeans(   data,   imageID = NULL,   cellType = NULL,   region = NULL,   markers = NULL,   assay = 1,   replaceVal = 0 )"},{"path":"https://sydneybiox.github.io/Statial/reference/getMarkerMeans.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the average expression for all markers for each cell type in each \nregion defined by lisaClust — getMarkerMeans","text":"data SingleCellExperiment object intensities data assays slot regions information colData generated lisaClust. imageID colData column stores image IDs. cellType colData column store cell types. region colData column stores regions. markers string vector markers proxy cell's state. NULL, markers  used. assay assay want use expression data. replaceVal value replace missing values .","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/getMarkerMeans.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract the average expression for all markers for each cell type in each \nregion defined by lisaClust — getMarkerMeans","text":"","code":"data(kerenSCE)  kerenSCE <- kerenSCE[,kerenSCE$imageID %in% c(\"5\",\"6\")]  regionSCE <- lisaClust::lisaClust(kerenSCE, k = 5) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'.  lisaClustOutput <- getMarkerMeans(regionSCE)"},{"path":"https://sydneybiox.github.io/Statial/reference/ggplotRs.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting the original and kontextual L values over a range of radii. — ggplotRs","title":"Plotting the original and kontextual L values over a range of radii. — ggplotRs","text":"function takes outputs rsCurve plots ggplot. standard deviation estimated rsCurve, confidence intervals constructed based standard deviation. confidence interval overlaps 0, relationship insignificant  radius.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/ggplotRs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting the original and kontextual L values over a range of radii. — ggplotRs","text":"","code":"ggplotRs(rsDf)"},{"path":"https://sydneybiox.github.io/Statial/reference/ggplotRs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting the original and kontextual L values over a range of radii. — ggplotRs","text":"rsDf data frame rsCurve.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/ggplotRs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting the original and kontextual L values over a range of radii. — ggplotRs","text":"ggplotly object showing original kontextual L function  values range radii","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/ggplotRs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting the original and kontextual L values over a range of radii. — ggplotRs","text":"","code":"data(\"kerenImage\")  rsDf <- rsCurve(   cells = kerenImage,   from = \"p53\",   to = \"Immune\",   parent = c(\"p53\", \"Keratin+Tumour\"),   rs = seq(10, 510, 100),   cores = 40 )  ggplotRs(rsDf)"},{"path":"https://sydneybiox.github.io/Statial/reference/headSCE.html","id":null,"dir":"Reference","previous_headings":"","what":"Head and neck cutaneous squamous cell carcinoma IMC data — headSCE","title":"Head and neck cutaneous squamous cell carcinoma IMC data — headSCE","text":"subset imaging mass cytometry dataset head neck cutaneous  squamous cell carcinoma Ferguson et al 2022. object contains 5 images.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/headSCE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Head and neck cutaneous squamous cell carcinoma IMC data — headSCE","text":"","code":"data(headSCE)"},{"path":"https://sydneybiox.github.io/Statial/reference/headSCE.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Head and neck cutaneous squamous cell carcinoma IMC data — headSCE","text":"headData SingleCellExperiment object","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/headSCE.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Head and neck cutaneous squamous cell carcinoma IMC data — headSCE","text":"Ferguson, . L., Sharman, . R., Allen, R. O., Ye, T., Lee, J. H., Low, T.-H. H., Ch'ng, S., Palme, C. E., Ashford, B., Ranson, M., Clark, J. R., Patrick, E., Gupta, R., & Palendira, U. (2022). High-Dimensional Spatial Analysis Reveals Immune Landscape–Dependent Progression Cutaneous Squamous Cell Carcinoma. Clinical Cancer Research, OF1-OF12. ([DOI](https://doi.org/10.1158/1078-0432.Ccr-22-1332))","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/isKontextual.html","id":null,"dir":"Reference","previous_headings":"","what":"Test whether an object is a kontextualResult — isKontextual","title":"Test whether an object is a kontextualResult — isKontextual","text":"Test whether object kontextualResult","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/isKontextual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test whether an object is a kontextualResult — isKontextual","text":"","code":"isKontextual(kontextualResult)"},{"path":"https://sydneybiox.github.io/Statial/reference/isKontextual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test whether an object is a kontextualResult — isKontextual","text":"kontextualResult object test","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/isKontextual.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test whether an object is a kontextualResult — isKontextual","text":"","code":"data = data.frame() if(!isKontextual(data)) print(\"Not a kontextualResult\") #> [1] \"Not a kontextualResult\""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenImage.html","id":null,"dir":"Reference","previous_headings":"","what":"MIBI-TOF Breast cancer image — kerenImage","title":"MIBI-TOF Breast cancer image — kerenImage","text":"single MIBI-TOF image breast cancer patient 6 Keren et al 2018 dataset.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenImage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MIBI-TOF Breast cancer image — kerenImage","text":"","code":"data(kerenImage)"},{"path":"https://sydneybiox.github.io/Statial/reference/kerenImage.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"MIBI-TOF Breast cancer image — kerenImage","text":"headData SingleCellExperiment object","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenImage.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"MIBI-TOF Breast cancer image — kerenImage","text":"Keren, L., Bosse, M., Marquez, D., Angoshtari, R., Jain, S., Varma, S., Yang, S. R., Kurian, ., Van Valen, D., West, R., Bendall, S. C., & Angelo, M. (2018). Structured Tumor-Immune Microenvironment Triple Negative Breast Cancer Revealed Multiplexed Ion Beam Imaging. Cell, 174(6), 1373-1387.e1319. ([DOI](https://doi.org/10.1016/j.cell.2018.08.039))","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenKontextual.html","id":null,"dir":"Reference","previous_headings":"","what":"Kontextual results from kerenSCE — kerenKontextual","title":"Kontextual results from kerenSCE — kerenKontextual","text":"kontextual results data.frame created using Kontextual kerenSCE dataset.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenKontextual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kontextual results from kerenSCE — kerenKontextual","text":"","code":"data(kerenKontextual)"},{"path":"https://sydneybiox.github.io/Statial/reference/kerenKontextual.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Kontextual results from kerenSCE — kerenKontextual","text":"kerenKontextual kontextual results object.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenSCE.html","id":null,"dir":"Reference","previous_headings":"","what":"MIBI-TOF Breast cancer intensities — kerenSCE","title":"MIBI-TOF Breast cancer intensities — kerenSCE","text":"single MIBI-TOF data breast cancer patient 6 Keren et al 2018 dataset.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenSCE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MIBI-TOF Breast cancer intensities — kerenSCE","text":"","code":"data(kerenSCE)"},{"path":"https://sydneybiox.github.io/Statial/reference/kerenSCE.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"MIBI-TOF Breast cancer intensities — kerenSCE","text":"kerenSCE SingleCellExperiment object","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kerenSCE.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"MIBI-TOF Breast cancer intensities — kerenSCE","text":"Keren, L., Bosse, M., Marquez, D., Angoshtari, R., Jain, S., Varma, S., Yang, S. R., Kurian, ., Van Valen, D., West, R., Bendall, S. C., & Angelo, M. (2018). Structured Tumor-Immune Microenvironment Triple Negative Breast Cancer Revealed Multiplexed Ion Beam Imaging. Cell, 174(6), 1373-1387.e1319. ([DOI](https://doi.org/10.1016/j.cell.2018.08.039))","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kontextCurve.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluation of Kontextual over a range of radii. — kontextCurve","title":"Evaluation of Kontextual over a range of radii. — kontextCurve","text":"function obtains `Kondtional` values range radii, standard  deviations value can obtained using permutation significance  testing. obtain estimates standard deviations specify `se = TRUE`.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kontextCurve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluation of Kontextual over a range of radii. — kontextCurve","text":"","code":"kontextCurve(   cells,   from,   to,   parent,   image = NULL,   rs = seq(10, 100, 10),   inhom = TRUE,   edge = FALSE,   se = FALSE,   nSim = 20,   cores = 1,   imageID = \"imageID\",   cellType = \"cellType\",   ... )"},{"path":"https://sydneybiox.github.io/Statial/reference/kontextCurve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluation of Kontextual over a range of radii. — kontextCurve","text":"cells single image SingleCellExperiment object first cell type evaluated pairwise relationship. second cell type evaluated pairwise relationship. parent parent population cell type (must include cell type). image vector images subset results . NULL default images. rs vector radii evaluate kontextual . inhom logical value indicating whether perform inhomogeneous L function. edge logical value indicating whether perform edge correction. se logical value indicate standard deviation kontextual calculated construct error bars. nSim Number randomisations perform using relabelKontextual, used calculated SE. cores Number cores parallel processing. imageID column colData stores image ids. cellType column colData stores cell types. ... arguments passed Kontextual.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kontextCurve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluation of Kontextual over a range of radii. — kontextCurve","text":"data frame original L values Kontextual values evaluated range radii.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kontextCurve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluation of Kontextual over a range of radii. — kontextCurve","text":"","code":"data(\"kerenSCE\")  kerenImage6 = kerenSCE[, kerenSCE$imageID ==\"6\"]  rsDf <- kontextCurve(   cells = kerenSCE,   from = \"CD4_Cell\",   to = \"Keratin_Tumour\",   parent = c(\"CD4_Cell\", \"Macrophages\"),   rs = seq(10, 510, 100),   cores = 2 )"},{"path":"https://sydneybiox.github.io/Statial/reference/kontextPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting the original and kontextual L values over a range of radii. — kontextPlot","title":"Plotting the original and kontextual L values over a range of radii. — kontextPlot","text":"function takes outputs rsCurve plots ggplot. standard deviation estimated rsCurve, confidence intervals constructed based standard deviation. confidence interval overlaps 0, relationship insignificant  radius.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kontextPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting the original and kontextual L values over a range of radii. — kontextPlot","text":"","code":"kontextPlot(rsDf)"},{"path":"https://sydneybiox.github.io/Statial/reference/kontextPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting the original and kontextual L values over a range of radii. — kontextPlot","text":"rsDf data frame kontextCurve.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kontextPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting the original and kontextual L values over a range of radii. — kontextPlot","text":"ggplotly object showing original kontextual L function  values range radii","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/kontextPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting the original and kontextual L values over a range of radii. — kontextPlot","text":"","code":"data(\"kerenSCE\")  kerenImage6 = kerenSCE[, kerenSCE$imageID ==\"6\"]  rsDf <- kontextCurve(   cells = kerenImage6,   from = \"p53\",   to = \"Immune\",   parent = c(\"p53\", \"Keratin+Tumour\"),   rs = seq(10, 510, 100),   cores = 2 )  kontextPlot(rsDf)"},{"path":"https://sydneybiox.github.io/Statial/reference/makeWindow.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a window for a PPP object — makeWindow","title":"Creates a window for a PPP object — makeWindow","text":"function creates window `spatstat::ppp` object, type  window can specified using `window` argument.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/makeWindow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a window for a PPP object — makeWindow","text":"","code":"makeWindow(data, window = \"square\", window.length = NULL)"},{"path":"https://sydneybiox.github.io/Statial/reference/makeWindow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a window for a PPP object — makeWindow","text":"data single image data frame SingleCellExperiment object PPP object. window shape window around regions, can `square`, `convex` `concave` window.length tuning parameter controlling level concavity estimating concave windows.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/makeWindow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a window for a PPP object — makeWindow","text":"Creates `owin` class, representing observation window image.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/makeWindow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Creates a window for a PPP object — makeWindow","text":"","code":"data <- data.frame(x = rnorm(10), y = rnorm(10)) ow <- makeWindow(data, window = \"square\")  spatstat.geom::ppp(x = data$x, y = data$y, window = ow) #> Planar point pattern: 10 points #> window: rectangle = [-1.0316158, 0.573778] x [-1.0193561, 1.4414436] units"},{"path":"https://sydneybiox.github.io/Statial/reference/parentCombinations.html","id":null,"dir":"Reference","previous_headings":"","what":"Create all combinations of cell type relationships from a list of parents — parentCombinations","title":"Create all combinations of cell type relationships from a list of parents — parentCombinations","text":"function takes named vectors parent populations  dataset, creates data frame containing pairwise cell relationships, data frame can inputed `parentDf` argument `Kontextual`.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/parentCombinations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create all combinations of cell type relationships from a list of parents — parentCombinations","text":"","code":"parentCombinations(all, ...)"},{"path":"https://sydneybiox.github.io/Statial/reference/parentCombinations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create all combinations of cell type relationships from a list of parents — parentCombinations","text":"list `` cell types Kontextual evaluated ... Vectors parent population","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/parentCombinations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create all combinations of cell type relationships from a list of parents — parentCombinations","text":"data frame containing pairwise cell relationships corresponding parent","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/parentCombinations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create all combinations of cell type relationships from a list of parents — parentCombinations","text":"","code":"tcells <- c(\"CD4\", \"CD8\") tissue <- c(\"epithelial\", \"stromal\") allCells <- c(\"tumour\", tissue, tcells)  parentCombinations(all = allCells, tcells, tissue) #>          from         to       parent parent_name #> 1         CD4     tumour     CD4, CD8      tcells #> 2         CD4 epithelial     CD4, CD8      tcells #> 3         CD4    stromal     CD4, CD8      tcells #> 4         CD4        CD8     CD4, CD8      tcells #> 5         CD8     tumour     CD4, CD8      tcells #> 6         CD8 epithelial     CD4, CD8      tcells #> 7         CD8    stromal     CD4, CD8      tcells #> 8         CD8        CD4     CD4, CD8      tcells #> 9  epithelial     tumour epitheli....      tissue #> 10 epithelial    stromal epitheli....      tissue #> 11 epithelial        CD4 epitheli....      tissue #> 12 epithelial        CD8 epitheli....      tissue #> 13    stromal     tumour epitheli....      tissue #> 14    stromal epithelial epitheli....      tissue #> 15    stromal        CD4 epitheli....      tissue #> 16    stromal        CD8 epitheli....      tissue"},{"path":"https://sydneybiox.github.io/Statial/reference/plotStateChanges.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualise Cell-Cell Marker Relationships — plotStateChanges","title":"Visualise Cell-Cell Marker Relationships — plotStateChanges","text":"Helper functions visualise OLS model fits image based state models","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/plotStateChanges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualise Cell-Cell Marker Relationships — plotStateChanges","text":"","code":"plotStateChanges(   cells,   image,   from,   to,   marker,   type = \"distances\",   assay = 1,   cellType = \"cellType\",   imageID = \"imageID\",   spatialCoords = c(\"x\", \"y\"),   size = 1,   shape = NULL,   interactive = FALSE,   plotModelFit = FALSE,   method = \"lm\" )"},{"path":"https://sydneybiox.github.io/Statial/reference/plotStateChanges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualise Cell-Cell Marker Relationships — plotStateChanges","text":"cells SingleCellExperiment distances already calculated. image image subset . character indicating name cell type (cellType column) whose cell state investigated character indicating name cell type (cellType column) may influencing cell state another cell type marker marker interest. type name reduced dimension use x-axis. assay Name assay stores marker expression. cellType name column colData stores cell types. imageID name column colData stores image ids. spatialCoords names columns colData store spatial coordinates. size Aesthetic numerical variable determining size displayed cells shape Aesthetic variable determining shape grouping displayed cells interactive Logical indicating output visualisation interactive (plotly) plotModelFit Logical indicating fitted values plotted actual intensities marker specified. default plot actual intensities method method build model . Currently option \"lm\". However, capabilities may expanded future","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/plotStateChanges.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualise Cell-Cell Marker Relationships — plotStateChanges","text":"image,","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/plotStateChanges.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualise Cell-Cell Marker Relationships — plotStateChanges","text":"","code":"library(dplyr) data(\"kerenSCE\")  kerenSCE <- getDistances(kerenSCE)  p <- plotStateChanges(   cells = kerenSCE,   type = \"distances\",   image = \"6\",   from = \"Keratin_Tumour\",   to = \"Macrophages\",   marker = \"p53\",   size = 1,   shape = 19,   interactive = FALSE,   plotModelFit = FALSE,   method = \"lm\")  p #> $image #> Error in ggplot2::stat_density_2d(data = data[data$cellType == to, ],     ggplot2::aes(x = x, y = y, fill = after_stat(density)), geom = \"raster\",     contour = FALSE): Problem while mapping stat to aesthetics. #> ℹ Error occurred in the 1st layer. #> Caused by error in `after_stat()`: #> ! could not find function \"after_stat\""},{"path":"https://sydneybiox.github.io/Statial/reference/prepMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Kontextual or state changes result to a matrix for classification — prepMatrix","title":"Convert Kontextual or state changes result to a matrix for classification — prepMatrix","text":"Convert Kontextual state changes result matrix classification","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/prepMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Kontextual or state changes result to a matrix for classification — prepMatrix","text":"","code":"prepMatrix(result, replaceVal = 0, column = NULL, test = NULL)"},{"path":"https://sydneybiox.github.io/Statial/reference/prepMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Kontextual or state changes result to a matrix for classification — prepMatrix","text":"result kontextual state changes result data.frame. replaceVal value NAs replaced . column column contains scores want select. test column containing column names expanded matrix.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/prepMatrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Kontextual or state changes result to a matrix for classification — prepMatrix","text":"","code":"data(\"kerenSCE\")   CD4_Kontextual <- Kontextual(   cells = kerenSCE,   r = 50,   from = \"Macrophages\",   to = \"Keratin_Tumour\",   parent = c(\"Macrophages\", \"CD4_Cell\"),   image = \"6\" )   kontextMat = prepMatrix(CD4_Kontextual)"},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKonditional.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell permutation for Kontextual — relabelKontextual","title":"Cell permutation for Kontextual — relabelKontextual","text":"Function randomises specified cells image calculates `Kontextual` value. can used estimate null distribution,  parent cell population significance testing. function relabels specified cells within single image,  estimate null distribution cell population specified.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKonditional.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell permutation for Kontextual — relabelKontextual","text":"","code":"relabelKontextual(   cells,   nSim = 1,   r,   from,   to,   parent,   returnImages = FALSE,   inhom = TRUE,   edge = FALSE,   cores = 1,   ... )  relabel(image, labels = NULL)"},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKonditional.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell permutation for Kontextual — relabelKontextual","text":"cells single image data frame SingleCellExperiment object nSim Number randomisations calculated. r Radius evaluated pairwise relationships cells. first cell type evaluated pairwise relationship. second cell type evaluated pairwise relationship. parent parent population cell type (must include cell type). returnImages logical value indicate whether function return randomised images along Kontextual values. inhom logical value indicating whether account inhomogeneity. edge logical value indicating whether perform edge correction. cores Number cores parallel processing. ... arguments passed Kontextual image single image Single Cell Experiment object. labels vector CellTypes labels permuted NULL cells labels radomised.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKonditional.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell permutation for Kontextual — relabelKontextual","text":"data frame containing Kontextual value randomised image. `returnImages = TRUE` function return list Kontextual values randomised images. data frame containing pairwise cell relationships corresponding parent","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKonditional.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell permutation for Kontextual — relabelKontextual","text":"","code":"data(\"kerenImage\")  relabelResult <- relabelKontextual(   cells = kerenImage,   nSim = 5,   r = 250,   from = \"p53\",   to = \"Immune\",   parent = c(\"p53\", \"Keratin+Tumour\"),   cores = 40 )  data(\"kerenImage\")  # Permute CD8 T cells and T cell labels in the image relabeledImage <- relabel(kerenImage, labels = c(\"p53\", \"Keratin+Tumour\")) plot(relabeledImage)"},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKontextual.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell permutation for Kontextual — relabelKontextual","title":"Cell permutation for Kontextual — relabelKontextual","text":"Function randomises specified cells image calculates `Kontextual` value. can used estimate null distribution,  parent cell population significance testing. function relabels specified cells within single image,  estimate null distribution cell population specified.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKontextual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell permutation for Kontextual — relabelKontextual","text":"","code":"relabelKontextual(   cells,   nSim = 1,   r,   from,   to,   parent,   returnImages = FALSE,   inhom = TRUE,   edge = FALSE,   cores = 1,   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   imageID = \"imageID\",   ... )  relabel(image, labels = NULL)"},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKontextual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell permutation for Kontextual — relabelKontextual","text":"cells single image data frame SingleCellExperiment object nSim Number randomisations calculated. r Radius evaluated pairwise relationships cells. first cell type evaluated pairwise relationship. second cell type evaluated pairwise relationship. parent parent population cell type (must include cell type). returnImages logical value indicate whether function return randomised images along Kontextual values. inhom logical value indicating whether account inhomogeneity. edge logical value indicating whether perform edge correction. cores Number cores parallel processing. spatialCoords character vector containing names two spatial dimansions data. Defaults `c(\"x\", \"y\")`. cellType name cell type field data. Defualts \"cellType\". imageID name image ID field data. Defualts \"imageID\". ... arguments passed Kontextual image single image Single Cell Experiment object. labels vector CellTypes labels permuted NULL cells labels radomised.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKontextual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell permutation for Kontextual — relabelKontextual","text":"data frame containing Kontextual value randomised image. `returnImages = TRUE` function return list Kontextual values randomised images. data frame containing pairwise cell relationships corresponding parent","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/relabelKontextual.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell permutation for Kontextual — relabelKontextual","text":"","code":"data(\"kerenSCE\")  kerenImage6 = kerenSCE[, kerenSCE$imageID ==\"6\"]  relabelResult <- relabelKontextual(   cells = kerenImage6,   nSim = 5,   r = 250,   from = \"CD4_Cell\",   to = \"Keratin_Tumour\",   parent = c(\"CD4_Cell\", \"Macrophages\"),   cores = 2 )  data(\"kerenSCE\")  kerenImage6 = kerenSCE[, kerenSCE$imageID ==\"6\"]  kerenImage6 <- kerenImage6 |>          SingleCellExperiment::colData() |>          data.frame()  # Permute CD8 T cells and T cell labels in the image relabeledImage <- relabel(kerenImage6, labels = c(\"p53\", \"Keratin+Tumour\")) plot(relabeledImage)"},{"path":"https://sydneybiox.github.io/Statial/reference/rsCurve.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluation of Kontextual over a range of radii. — rsCurve","title":"Evaluation of Kontextual over a range of radii. — rsCurve","text":"function obtains `Kondtional` values range radii, standard  deviations value can obtained using permutation significance  testing. obtain estimates standard deviations specify `se = TRUE`.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/rsCurve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluation of Kontextual over a range of radii. — rsCurve","text":"","code":"rsCurve(   cells,   from,   to,   parent,   rs = seq(10, 100, 10),   inhom = TRUE,   edge = FALSE,   se = FALSE,   nSim = 20,   cores = 1,   ... )"},{"path":"https://sydneybiox.github.io/Statial/reference/rsCurve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluation of Kontextual over a range of radii. — rsCurve","text":"cells single image data frame SingleCellExperiment object first cell type evaluated pairwise relationship. second cell type evaluated pairwise relationship. parent parent population cell type (must include cell type). rs vector radii evaluate kontextual . inhom logical value indicating whether perform inhomogeneous L function. edge logical value indicating whether perform edge correction. se logical value indicate standard deviation kontextual calculated construct error bars. nSim Number randomisations perform using relabelKontextual, used calculated SE. cores Number cores parallel processing. ... arguments passed Kontextual.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/rsCurve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluation of Kontextual over a range of radii. — rsCurve","text":"data frame original L values Kontextual values evaluated range radii.","code":""},{"path":"https://sydneybiox.github.io/Statial/reference/rsCurve.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluation of Kontextual over a range of radii. — rsCurve","text":"","code":"data(\"kerenImage\")  rsDf <- rsCurve(   cells = kerenImage,   from = \"p53\",   to = \"Immune\",   parent = c(\"p53\", \"Keratin+Tumour\"),   rs = seq(10, 510, 100),   cores = 40 )"}]
