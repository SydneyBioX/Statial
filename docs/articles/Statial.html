<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Statial">
<title>Statial • Statial</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statial">
<meta property="og:description" content="Statial">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Statial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/Statial.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Statial</h1>
                        <h4 data-toc-skip class="author">Farhan
Ameen</h4>
            <address class="author_afil">
      School of Mathematics and Statistics, University of Sydney,
Australia<br><h4 data-toc-skip class="author">Sourish
Iyengar</h4>
            <address class="author_afil">
      School of Mathematics and Statistics, University of Sydney,
Australia<br><h4 data-toc-skip class="author">Ellis
Patrick</h4>
            <address class="author_afil">
      Westmead Institute for Medical Research, University of Sydney,
AustraliaSchool of Mathematics and Statistics, University of Sydney,
Australia<br><h4 data-toc-skip class="date">9 November 2022</h4>
      
      
      <div class="d-none name"><code>Statial.Rmd</code></div>
    </address>
</address>
</address>
</div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Statial</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the package from Bioconductor</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"Statial"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>There are over 37 trillion cells in the human body, each taking up
different forms and functions. The behaviour of these cells can be
described by canonical characteristics, but their functions can also
dynamically change based on their environmental context, leading to
cells with diverse states. Understanding changes in cell state and the
interplay between cells is key to understanding their mechanisms of
action and how they contribute to human disease. <code>Statial</code> is
a suite of functions for identifying changes in cell state. This guide
will provide a step-by-step overview of some key functions within
<code>Statial</code>.</p>
</div>
<div class="section level2">
<h2 id="evaluating-cell-localisation">Evaluating cell localisation<a class="anchor" aria-label="anchor" href="#evaluating-cell-localisation"></a>
</h2>
<p><code>Konditional</code> is a method to evaluate the localisation
relationship between two cell types in an image.
<code>Konditional</code> builds on the L-function by contextualising the
relationship between two cell types in reference to the typical spatial
behaviour of a <span class="math inline">\(3^{rd}\)</span> cell
type/population. By taking this approach, <code>Konditional</code> is
invariant to changes in the window of the image as well as tissue
structures which may be present.</p>
<p>The definitions of cell types and cell states are somewhat ambiguous,
cell types imply well defined groups of cells that serve different roles
from one another, on the other hand cell states imply that cells are a
dynamic entity which cannot be discretised, and thus exist in a
continuum. For the purposes of using <code>Konditional</code> we treat
cell states as identified clusters of cells, where larger clusters
represent a “parent” cell population, and finer sub-clusters
representing a “child” cell population. For example a CD4 T cell may be
considered a child to a larger parent population of Immune cells.
<code>Konditional</code> thus aims to see how a child population of
cells deviate from the spatial behaviour of their parent population, and
how that influences the localisation between the child cell state and
another cell state.</p>
</div>
<div class="section level2">
<h2 id="loading-example-data">Loading example data<a class="anchor" aria-label="anchor" href="#loading-example-data"></a>
</h2>
<p>In the following we will analyse cutaneous squamous cell carcinoma
data from the head and neck region (Ferguson et al. 2022). These images
are stored in a <code>SingleCellExperiment</code> object. The first step
in analysing these images is to organise all the cells present into cell
state populations or clusters, e.g. all the different B cell types are
put in a vector called bcells.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load head and neck data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"headSCE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine all cell types in image</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">headSCE</span><span class="op">$</span><span class="va">cellType</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] EC1       SC7       MC3       Undefined BC3       SC1       SC2      </span></span>
<span><span class="co">#&gt;  [8] EP        SC4       BC2       TC_CD4    SC5       EC2       BC1      </span></span>
<span><span class="co">#&gt; [15] SC3       MC2       GC        SC6       MC1       TC_CD8   </span></span>
<span><span class="co">#&gt; 20 Levels: BC1 BC2 BC3 EC1 EC2 EP GC MC1 MC2 MC3 SC1 SC2 SC3 SC4 SC5 ... Undefined</span></span>
<span></span>
<span><span class="co"># Set up cell populations</span></span>
<span><span class="va">tumour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SC1"</span>, <span class="st">"SC2"</span>, <span class="st">"SC3"</span>, <span class="st">"SC4"</span>, <span class="st">"SC5"</span>, <span class="st">"SC6"</span>, <span class="st">"SC7"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bcells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC1"</span>, <span class="st">"BC2"</span>, <span class="st">"BC3"</span><span class="op">)</span></span>
<span><span class="va">tcells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TC_CD4"</span>, <span class="st">"TC_CD8"</span><span class="op">)</span></span>
<span><span class="va">myeloid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MC1"</span>, <span class="st">"MC2"</span>, <span class="st">"MC3"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">endothelial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EC1"</span>, <span class="st">"EC2"</span><span class="op">)</span></span>
<span><span class="va">epithelial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EP"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tissue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">endothelial</span>, <span class="va">epithelial</span><span class="op">)</span></span>
<span><span class="va">immune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bcells</span>, <span class="va">tcells</span>, <span class="va">myeloid</span>, <span class="st">"GC"</span><span class="op">)</span> <span class="co"># GC = granulocytes</span></span>
<span></span>
<span><span class="va">all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tumour</span>, <span class="va">tissue</span>, <span class="va">immune</span>, <span class="st">"Undefined"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="konditional">Konditional<a class="anchor" aria-label="anchor" href="#konditional"></a>
</h2>
<p><code>Konditional</code> accepts a <code>SingleCellExperiment</code>
object, or a single image, or list of images from a
<code>SingleCellExperiment</code> object, this gets passed into the
<code>cells</code> argument. The two cell types which will be evaluated
are specified in the <code>to</code> and <code>from</code> arguments. A
parent population must also be specified in the <code>parent</code>
argument, note the parent cell population must include the
<code>to</code> cell type. The argument <code>r</code> will specify the
radius which the cell relationship will be evaluated on.
<code>Konditional</code> supports parallel processing, the number of
cores can be specified using the <code>cores</code> argument.
<code>Konditional</code> can take a single value or multiple values for
each argument and will test all combinations of the arguments
specified.</p>
<p>Here we test the relationship between CD4 T cells
(<code>TC_CD4</code>) and one type of Tumour cell (<code>SC1</code>)
with all immune cells being our parent population. The output is a data
frame with the <code>original</code> L-function values and
<code>konditional</code> values as well as the values for the arguments
specified. Where a negative <code>original</code> or
<code>konditional</code> value represents dispersion between
<code>TC_CD4</code> and <code>SC1</code> and a positive value indicates
localisation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CD4_Konditional</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Konditional.html">Konditional</a></span><span class="op">(</span></span>
<span>  cells <span class="op">=</span> <span class="va">headSCE</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"TC_CD4"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"SC1"</span>,</span>
<span>  parent <span class="op">=</span> <span class="va">immune</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CD4_Konditional</span><span class="op">)</span></span>
<span><span class="co">#&gt;   imageID        test  original konditional  r weightQuantile inhom  edge</span></span>
<span><span class="co">#&gt; 1       1 TC_CD4__SC1 -4.990157 -4.87036888 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 2       5 TC_CD4__SC1 -5.122654 -0.02746783 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 3       6 TC_CD4__SC1 -7.945885 -4.75753347 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 4       7 TC_CD4__SC1 -1.301764  1.84603274 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 5       8 TC_CD4__SC1  4.951783  3.33973263 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt;   includeZeroCells window window.length</span></span>
<span><span class="co">#&gt; 1             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 2             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 3             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 4             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 5             TRUE convex            NA</span></span></code></pre></div>
<p>The <code>original</code> and <code>konditional</code> values can be
compared in a scatter plot to identify relationships which have been
identified differently between the functions. The dashed red line
represents the expected pattern of the data, i.e. where there exists no
relationship between the two cell types. The top left quadrant therefore
represents values where <code>Konditional</code> has identified
localisation between <code>CD4</code> and <code>SC1</code> and the
original L-function has identified dispersion, the opposite is true for
the bottom right quadrant.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">CD4_Konditional</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">original</span>, y <span class="op">=</span> <span class="va">konditional</span>, col <span class="op">=</span> <span class="va">imageID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Statial_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Alternatively all pairwise cell relationships and their corresponding
parent in the dataset can be tested. A data frame with all pairwise
combinations can be creating using the <code>parentCombinations</code>
function. This function takes in a vector of all the cells, as well as
all the parent vectors set up earlier. As shown below the output is a
data frame specifying the <code>to</code>, <code>from</code>, and
<code>parent</code> arguments for <code>Konditional</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all relationships between cell types and their parents</span></span>
<span><span class="va">parentDf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parentCombinations.html">parentCombinations</a></span><span class="op">(</span></span>
<span>  all <span class="op">=</span> <span class="va">all</span>,</span>
<span>  <span class="va">tumour</span>,</span>
<span>  <span class="va">bcells</span>,</span>
<span>  <span class="va">tcells</span>,</span>
<span>  <span class="va">myeloid</span>,</span>
<span>  <span class="va">endothelial</span>,</span>
<span>  <span class="va">epithelial</span>,</span>
<span>  <span class="va">tissue</span>,</span>
<span>  <span class="va">immune</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">parentDf</span><span class="op">)</span></span>
<span><span class="co">#&gt;   from  to       parent parent_name</span></span>
<span><span class="co">#&gt; 1  BC1 SC1 BC1, BC2....      bcells</span></span>
<span><span class="co">#&gt; 2  BC1 SC2 BC1, BC2....      bcells</span></span>
<span><span class="co">#&gt; 3  BC1 SC3 BC1, BC2....      bcells</span></span>
<span><span class="co">#&gt; 4  BC1 SC4 BC1, BC2....      bcells</span></span>
<span><span class="co">#&gt; 5  BC1 SC5 BC1, BC2....      bcells</span></span>
<span><span class="co">#&gt; 6  BC1 SC6 BC1, BC2....      bcells</span></span></code></pre></div>
<p>Rather than specifying <code>to</code>, <code>from</code>, and
<code>parent</code> in Konditional, the output from
<code>parentCombinations</code> can be inputed into
<code>Konditional</code> using the <code>parentDf</code> argument. Here
we will test the first 20 pairwise cell relationships in
<code>parentCombinations</code> on the first image of the dataset.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Selecting Image 1 as an example</span></span>
<span><span class="va">image_1</span> <span class="op">&lt;-</span> <span class="va">headSCE</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">imageID</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">image1_Konditional</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Konditional.html">Konditional</a></span><span class="op">(</span></span>
<span>  cells <span class="op">=</span> <span class="va">image_1</span>,</span>
<span>  parentDf <span class="op">=</span> <span class="va">parentDf</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="op">]</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">image1_Konditional</span><span class="op">)</span></span>
<span><span class="co">#&gt;   imageID             test   original konditional  r weightQuantile inhom  edge</span></span>
<span><span class="co">#&gt; 1       1 BC1__SC1__bcells  0.5812206    4.630450 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 2       1 BC1__SC2__bcells -7.1248136   -8.571246 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 3       1 BC1__SC3__bcells -9.0872476  -10.469486 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 4       1 BC1__SC4__bcells  1.3391851   -1.813705 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 5       1 BC1__SC5__bcells  6.9660272    5.263392 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt; 6       1 BC1__SC6__bcells -8.5564596   -4.657076 50            0.8  TRUE FALSE</span></span>
<span><span class="co">#&gt;   includeZeroCells window window.length</span></span>
<span><span class="co">#&gt; 1             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 2             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 3             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 4             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 5             TRUE convex            NA</span></span>
<span><span class="co">#&gt; 6             TRUE convex            NA</span></span></code></pre></div>
<p>#RsCurve</p>
<p>Here we examine an image were the relationship between 2 cell types
depends on a parent cell population. This is a breast cancer image
obtained from Keren et al, 2018 from patient 6. In the image below we
can see that <code>p53</code> and <code>Immune</code> are dispersed.
However when the behaviour of <code>p53</code> is placed in the context
of the spatial behaviour of its parent population
<code>Keratin+Tumour</code>, <code>p53</code> and <code>Immune</code>
now appear localised.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"kerenImage"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kerenImage</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cellType</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Keratin+Tumour"</span>, <span class="st">"Immune"</span>, <span class="st">"p53"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">cellType</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">cellType</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#505050"</span>, <span class="st">"#D6D6D6"</span>, <span class="st">"#64BC46"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Statial_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The <code>rsCurve</code> function plots the L-function value and
Konditional values over a range of radii. If the points lie above the
red line (expected pattern) then localisation is indicated for that
radius, if the points lie below the red line then dispersion is
indicated. As seen in the following plot Konditional is able to
correctly identify localisation between <code>p53</code> and
<code>Immune</code> in the example image for a certain range of radii.
When the radius gets too large the overall relationship between
<code>p53</code> and <code>Immune</code> looks dispersed. The original
L-function is not able to identify localisation at any value of
radii.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsDf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rsCurve.html">rsCurve</a></span><span class="op">(</span></span>
<span>  cells <span class="op">=</span> <span class="va">kerenImage</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"p53"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"Immune"</span>,</span>
<span>  parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p53"</span>, <span class="st">"Keratin+Tumour"</span><span class="op">)</span>,</span>
<span>  rs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">510</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggplotRs.html">ggplotRs</a></span><span class="op">(</span><span class="va">rsDf</span><span class="op">)</span></span></code></pre></div>
<p><img src="Statial_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Ferguson, A. L., Sharman, A. R., Allen, R. O., Ye, T., Lee, J. H.,
Low, T.-H. H., Ch’ng, S., Palme, C. E., Ashford, B., Ranson, M., Clark,
J. R., Patrick, E., Gupta, R., &amp; Palendira, U. (2022).
High-Dimensional and Spatial Analysis Reveals Immune Landscape–Dependent
Progression in Cutaneous Squamous Cell Carcinoma. Clinical Cancer
Research, OF1-OF12. (<a href="https://doi.org/10.1158/1078-0432.Ccr-22-1332" class="external-link">DOI</a>)</p>
<p>Keren, L., Bosse, M., Marquez, D., Angoshtari, R., Jain, S., Varma,
S., Yang, S. R., Kurian, A., Van Valen, D., West, R., Bendall, S. C.,
&amp; Angelo, M. (2018). A Structured Tumor-Immune Microenvironment in
Triple Negative Breast Cancer Revealed by Multiplexed Ion Beam Imaging.
Cell, 174(6), 1373-1387.e1319. (<a href="https://doi.org/10.1016/j.cell.2018.08.039" class="external-link">DOI</a>)</p>
</div>
<div class="section level2">
<h2 id="sessioninfo">sessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: EndeavourOS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/libblas.so.3.10.1</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/liblapack.so.3.10.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] SingleCellExperiment_1.20.0 SummarizedExperiment_1.28.0</span></span>
<span><span class="co">#&gt;  [3] Biobase_2.58.0              GenomicRanges_1.50.1       </span></span>
<span><span class="co">#&gt;  [5] GenomeInfoDb_1.34.2         IRanges_2.32.0             </span></span>
<span><span class="co">#&gt;  [7] S4Vectors_0.36.0            BiocGenerics_0.44.0        </span></span>
<span><span class="co">#&gt;  [9] MatrixGenerics_1.10.0       matrixStats_0.62.0         </span></span>
<span><span class="co">#&gt; [11] forcats_0.5.2               stringr_1.4.1              </span></span>
<span><span class="co">#&gt; [13] dplyr_1.0.10                purrr_0.3.5                </span></span>
<span><span class="co">#&gt; [15] readr_2.1.3                 tidyr_1.2.1                </span></span>
<span><span class="co">#&gt; [17] tibble_3.1.8                ggplot2_3.4.0              </span></span>
<span><span class="co">#&gt; [19] tidyverse_1.3.2             Statial_0.99.5             </span></span>
<span><span class="co">#&gt; [21] BiocStyle_2.26.0           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] googledrive_2.0.0      colorspace_2.0-3       deldir_1.0-6          </span></span>
<span><span class="co">#&gt;   [4] ellipsis_0.3.2         rprojroot_2.0.3        XVector_0.38.0        </span></span>
<span><span class="co">#&gt;   [7] fftwtools_0.9-11       fs_1.5.2               spatstat.data_3.0-0   </span></span>
<span><span class="co">#&gt;  [10] farver_2.1.1           fansi_1.0.3            lubridate_1.9.0       </span></span>
<span><span class="co">#&gt;  [13] xml2_1.3.3             codetools_0.2-18       splines_4.2.2         </span></span>
<span><span class="co">#&gt;  [16] cachem_1.0.6           knitr_1.40             polyclip_1.10-4       </span></span>
<span><span class="co">#&gt;  [19] jsonlite_1.8.3         broom_1.0.1            dbplyr_2.2.1          </span></span>
<span><span class="co">#&gt;  [22] spatstat.linnet_2.3-2  spatstat.sparse_3.0-0  BiocManager_1.30.19   </span></span>
<span><span class="co">#&gt;  [25] compiler_4.2.2         httr_1.4.4             backports_1.4.1       </span></span>
<span><span class="co">#&gt;  [28] assertthat_0.2.1       Matrix_1.5-1           fastmap_1.1.0         </span></span>
<span><span class="co">#&gt;  [31] gargle_1.2.1           cli_3.4.1              htmltools_0.5.3       </span></span>
<span><span class="co">#&gt;  [34] tools_4.2.2            gtable_0.3.1           glue_1.6.2            </span></span>
<span><span class="co">#&gt;  [37] GenomeInfoDbData_1.2.9 spatstat_2.3-4         cellranger_1.1.0      </span></span>
<span><span class="co">#&gt;  [40] jquerylib_0.1.4        pkgdown_2.0.6          vctrs_0.5.0           </span></span>
<span><span class="co">#&gt;  [43] nlme_3.1-160           spatstat.random_3.0-1  xfun_0.34             </span></span>
<span><span class="co">#&gt;  [46] rvest_1.0.3            timechange_0.1.1       lifecycle_1.0.3       </span></span>
<span><span class="co">#&gt;  [49] googlesheets4_1.0.1    goftest_1.2-3          zlibbioc_1.44.0       </span></span>
<span><span class="co">#&gt;  [52] scales_1.2.1           spatstat.core_2.4-4    ragg_1.2.4            </span></span>
<span><span class="co">#&gt;  [55] hms_1.1.2              spatstat.utils_3.0-1   parallel_4.2.2        </span></span>
<span><span class="co">#&gt;  [58] yaml_2.3.6             curl_4.3.3             memoise_2.0.1         </span></span>
<span><span class="co">#&gt;  [61] sass_0.4.2             rpart_4.1.19           stringi_1.7.8         </span></span>
<span><span class="co">#&gt;  [64] highr_0.9              desc_1.4.2             BiocParallel_1.32.1   </span></span>
<span><span class="co">#&gt;  [67] rlang_1.0.6            pkgconfig_2.0.3        systemfonts_1.0.4     </span></span>
<span><span class="co">#&gt;  [70] bitops_1.0-7           evaluate_0.18          lattice_0.20-45       </span></span>
<span><span class="co">#&gt;  [73] tensor_1.5             labeling_0.4.2         tidyselect_1.2.0      </span></span>
<span><span class="co">#&gt;  [76] magrittr_2.0.3         bookdown_0.29          R6_2.5.1              </span></span>
<span><span class="co">#&gt;  [79] generics_0.1.3         DelayedArray_0.24.0    DBI_1.1.3             </span></span>
<span><span class="co">#&gt;  [82] withr_2.5.0            pillar_1.8.1           haven_2.5.1           </span></span>
<span><span class="co">#&gt;  [85] mgcv_1.8-41            abind_1.4-5            RCurl_1.98-1.9        </span></span>
<span><span class="co">#&gt;  [88] crayon_1.5.2           modelr_0.1.9           utf8_1.2.2            </span></span>
<span><span class="co">#&gt;  [91] spatstat.geom_3.0-3    tzdb_0.3.0             rmarkdown_2.17        </span></span>
<span><span class="co">#&gt;  [94] grid_4.2.2             readxl_1.4.1           data.table_1.14.4     </span></span>
<span><span class="co">#&gt;  [97] reprex_2.0.2           digest_0.6.30          textshaping_0.3.6     </span></span>
<span><span class="co">#&gt; [100] munsell_0.5.0          concaveman_1.1.0       bslib_0.4.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Farhan Ameen, Sourish Iyengar, Shila Ghazanfar, Ellis Patrick.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
